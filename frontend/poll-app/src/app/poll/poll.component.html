<div class="poll-container">
    <!-- Alert Messages -->
    <div class="alert-container">
        <div *ngIf="errorMessage" class="alert alert-error">
            <svg class="alert-icon" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
            </svg>
            {{ errorMessage }}
        </div>
        <div *ngIf="successMessage" class="alert alert-success">
            <svg class="alert-icon" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
            </svg>
            {{ successMessage }}
        </div>
    </div>

    <!-- Create Poll Section -->
    <div class="create-poll-section">
        <div class="section-header">
            <h2 class="section-title">
                <svg class="title-icon" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"/>
                </svg>
                Create a New Poll
            </h2>
            <p class="section-subtitle">Ask a question and provide multiple options for voting</p>
        </div>
        
        <div class="form-card">
            <div class="form-group">
                <label class="form-label">Poll Question</label>
                <input 
                    [(ngModel)]="newPoll.question" 
                    placeholder="What would you like to ask?" 
                    class="form-input"
                    [disabled]="isCreating"
                />
            </div>
            
            <div class="form-group">
                <label class="form-label">Options</label>
                <div class="options-container">
                    <div *ngFor="let option of newPoll.options; let i=index; trackBy:trackByIndex" class="option-input-group">
                        <div class="option-number">{{ i + 1 }}</div>
                        <input 
                            [(ngModel)]="option.optionText" 
                            [placeholder]="'Option ' + (i + 1)" 
                            class="form-input option-input"
                            [disabled]="isCreating"
                        />
                        <button 
                            *ngIf="newPoll.options.length > 2" 
                            (click)="removeOption(i)" 
                            class="btn-remove"
                            [disabled]="isCreating"
                            type="button"
                        >
                            <svg viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="button-group">
                <button 
                    (click)="addOption()" 
                    class="btn btn-secondary"
                    [disabled]="isCreating"
                    type="button"
                >
                    <svg class="btn-icon" viewBox="0 0 20 20" fill="currentColor">
                        <path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"/>
                    </svg>
                    Add Option
                </button>
                <button 
                    (click)="createPoll()" 
                    class="btn btn-primary"
                    [disabled]="isCreating"
                    type="button"
                >
                    <span *ngIf="!isCreating">
                        <svg class="btn-icon" viewBox="0 0 20 20" fill="currentColor">
                            <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"/>
                        </svg>
                        Create Poll
                    </span>
                    <span *ngIf="isCreating" class="loading-spinner">
                        <svg class="spinner" viewBox="0 0 24 24">
                            <circle class="spinner-circle" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"/>
                        </svg>
                        Creating...
                    </span>
                </button>
            </div>
        </div>
    </div>

    <!-- Available Polls Section -->
    <div class="polls-section">
        <div class="section-header">
            <h2 class="section-title">
                <svg class="title-icon" viewBox="0 0 20 20" fill="currentColor">
                    <path d="M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z"/>
                </svg>
                Active Polls
            </h2>
            <p class="section-subtitle">Vote on the polls below</p>
        </div>

        <!-- Loading State -->
        <div *ngIf="isLoading" class="loading-container">
            <svg class="loading-spinner-large" viewBox="0 0 24 24">
                <circle class="spinner-circle" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"/>
            </svg>
            <p>Loading polls...</p>
        </div>

        <!-- Empty State -->
        <div *ngIf="!isLoading && polls.length === 0" class="empty-state">
            <svg class="empty-icon" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"/>
            </svg>
            <h3>No polls yet</h3>
            <p>Be the first to create a poll!</p>
        </div>

        <!-- Polls List -->
        <div class="polls-grid" *ngIf="!isLoading && polls.length > 0">
            <div *ngFor="let poll of polls; trackBy:trackByPollId" class="poll-card">
                <h3 class="poll-question">{{ poll.question }}</h3>
                <div class="poll-options">
                    <button 
                        *ngFor="let option of poll.options; let i=index" 
                        (click)="vote(poll.id, i)" 
                        class="option-button"
                        [disabled]="votingPollId === poll.id"
                        [class.voting]="votingPollId === poll.id"
                    >
                        <span class="option-text">{{ option.optionText }}</span>
                        <span class="vote-badge">
                            <svg class="vote-icon" viewBox="0 0 20 20" fill="currentColor">
                                <path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v.667a4 4 0 01-.8 2.4L6.8 7.933a4 4 0 00-.8 2.4z"/>
                            </svg>
                            {{ option.voteCount }}
                        </span>
                    </button>
                </div>
                <div class="poll-footer">
                    <span class="total-votes">
                        Total votes: {{ getTotalVotes(poll) }}
                    </span>
                </div>
            </div>
        </div>
    </div>
</div>